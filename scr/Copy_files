#!/bin/ksh

function itoc {
   if (( $1 >= 0 && $1 < 10 ))
   then
      echo 0$1
   elif (( $1 >= 10 && $1 < 100 ))
   then
      echo $1
   else
      echo error
   fi
}


# Function for simple arithmetic with real numbers
function calc {

    awk "BEGIN { print $@ }"
}

. $SCR/Env_exp

set +x

#**************************************************
# First copy the HTB observation files
#**************************************************

cd $OBSPATH || exit
if [[ ${STATIONS} == "HTB" ]] then
 rm -f vobs[0-9]*[0-9]
fi

DTG=${SDATE}00
DTGEND=${EDATE}00
DTGEND=`newdate $DTGEND +24`

while [ $DTG -le ${DTGEND} ]; do

 echo "Copying: vobs"$DTG

 cp vhtb${DTG} vobs${DTG}

 DTG=`newdate $DTG +3`
done

#**************************************************
# Secondly, copy the HTB fldextr files
#**************************************************

#set -x

cd ${MODPATH[1]} || exit
if [[ ${STATIONS} == "HTB" ]] then
 rm -f vfld???[0-9]*[0-9]
fi

DTG=${SDATE}00
DTGEND=${EDATE}00

while [ $DTG -le ${DTGEND} ]; do

 FEXP=1
 while [ $FEXP -le $NEXP ]; do

   if [[ ${EXP[$FEXP]} == "ARO" ]] then
     LL=3
   else
     LL=0
   fi

   while [ $LL -le 24 ]; do
     
     echo "Copying: vfld${EXP[$FEXP]}"$DTG$(itoc $LL)
     cp vfld${EXP[$FEXP]}htb${DTG}$(itoc $LL) vfld${EXP[$FEXP]}${DTG}$(itoc $LL)

     let LL+=3
   done
   let FEXP+=1
 done

 DTG=`newdate $DTG +24`
done

exit